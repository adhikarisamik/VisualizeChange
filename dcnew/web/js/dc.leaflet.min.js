/*!
 *  dc.leaflet 0.1.0
 *  http://dc-js.github.io/dc.leaflet.js/
 *  Copyright 2015 Boyan Yurukov and the dc.leaflet Developers
 *  https://github.com/dc-js/dc.leaflet.js/blob/master/AUTHORS
 *
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License.
 */

!function(){function a(a){"use strict";var b={version:"0.1.0"};return b.leafletBase=function(b){b=a.baseChart(b);var c,d=!1,e=!1,f=!1,g=function(a){L.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(a)};return b._doRender=function(){return c=L.map(b.root().node(),d),e&&f&&c.setView(b.toLocArray(e),f),b.tiles()(c),b._postRender(),b._doRedraw()},b._postRender=function(){},b.mapOptions=function(a){return arguments.length?(d=a,b):d},b.center=function(a){return arguments.length?(e=a,b):e},b.zoom=function(a){return arguments.length?(f=a,b):f},b.tiles=function(a){return arguments.length?(g=a,b):g},b.map=function(){return c},b.toLocArray=function(a){return"string"==typeof a&&(a=a.split(",")),a},b},b.markerChart=function(c,d){var e=b.leafletBase({}),f=!0,g=!1,h=!1,i=!1,j=!0,k=!1,l=!1,m=!1,n=!1,o=[],p=!1;e.renderTitle(!0);var q=function(a){return e.keyAccessor()(a)},r=function(a){var b=new L.Marker(e.toLocArray(e.locationAccessor()(a)),{title:e.renderTitle()?e.title()(a):"",alt:e.renderTitle()?e.title()(a):"",icon:s(),clickable:e.renderPopup()||e.brushOn()&&!k,draggable:!1});return b},s=function(){return new L.Icon.Default},t=function(a){return e.title()(a)};e._postRender=function(){e.brushOn()&&(k&&e.filterHandler(x),e.map().on("zoomend moveend",w,this),k||e.map().on("click",w,this),e.map().on("zoomstart",v,this)),n=g?new L.MarkerClusterGroup(h?h:null):new L.LayerGroup,e.map().addLayer(n)},e._doRedraw=function(){var a=e._computeOrderedGroups(e.data()).filter(function(a){return 0!==e.valueAccessor()(a)});if(!p||p.toString()!==a.toString()){p=a,i&&(o=[]),n.clearLayers();var b=[];a.forEach(function(a){var c=e.keyAccessor()(a),d=null;d=!i&&c in o?o[c]:u(a,c),e.cluster()?b.push(d):n.addLayer(d)}),e.cluster()&&b.length>0&&n.addLayers(b)}},e.locationAccessor=function(a){return arguments.length?(q=a,e):q},e.marker=function(a){return arguments.length?(r=a,e):r},e.icon=function(a){return arguments.length?(s=a,e):s},e.popup=function(a){return arguments.length?(t=a,e):t},e.renderPopup=function(a){return arguments.length?(f=a,e):f},e.cluster=function(a){return arguments.length?(g=a,e):g},e.clusterOptions=function(a){return arguments.length?(h=a,e):h},e.rebuildMarkers=function(a){return arguments.length?(i=a,e):i},e.brushOn=function(a){return arguments.length?(j=a,e):j},e.filterByArea=function(a){return arguments.length?(k=a,e):k},e.markerGroup=function(){return n};var u=function(a,b){var c=r(a);return c.key=b,e.renderPopup()&&c.bindPopup(e.popup()(a,c)),e.brushOn()&&!k&&c.on("click",y),o[b]=c,c},v=function(){m=!0},w=function(b){if("moveend"!==b.type||!m&&!b.hard)if(m=!1,k){var c;c=e.map().getCenter().equals(e.center())&&e.map().getZoom()===e.zoom()?null:e.map().getBounds(),a.events.trigger(function(){e.filter(null),c&&(l=!0,e.filter(c),l=!1),a.redrawAll(e.chartGroup())})}else e.filter()&&("click"===b.type||-1!==o.indexOf(e.filter())&&!e.map().getBounds().contains(o[e.filter()].getLatLng()))&&a.events.trigger(function(){e.filter(null),f&&e.map().closePopup(),a.redrawAll(e.chartGroup())})},x=function(a,b){e.dimension().filter(null),b&&b.length>0&&(e.dimension().filterFunction(function(a){if(!(a in o))return!1;var c=o[a].getLatLng();return c&&b[0].contains(c)}),l||e.map().getBounds().toString===b[0].toString()||e.map().fitBounds(b[0]))},y=function(b){if(b.target){var c=b.target.key;a.events.trigger(function(){e.filter(c),a.redrawAll(e.chartGroup())})}};return e.anchor(c,d)},b.choroplethChart=function(c,d){var e=a.colorChart(b.leafletBase({})),f=!1,g=[],h=!1,i=!0,j=!0,k={fillColor:"black",color:"gray",opacity:.4,fillOpacity:.6,weight:1},l=function(a){return a.key},m=function(a){var b=e.featureOptions();b instanceof Function&&(b=b(a)),b=JSON.parse(JSON.stringify(b));var c=g[e.featureKeyAccessor()(a)];return c&&c.d&&(b.fillColor=e.getColor(c.d,c.i),-1!==e.filters().indexOf(c.d.key)&&(b.opacity=.8,b.fillOpacity=1)),b},n=function(a){return e.title()(a)};e._postRender=function(){f=L.geoJson(e.geojson(),{style:e.featureStyle(),onEachFeature:o}),e.map().addLayer(f)},e._doRedraw=function(){f.clearLayers(),g=[],e._computeOrderedGroups(e.data()).forEach(function(a,b){g[e.keyAccessor()(a)]={d:a,i:b}}),f.addData(e.geojson())},e.geojson=function(a){return arguments.length?(h=a,e):h},e.featureOptions=function(a){return arguments.length?(k=a,e):k},e.featureKeyAccessor=function(a){return arguments.length?(l=a,e):l},e.featureStyle=function(a){return arguments.length?(m=a,e):m},e.popup=function(a){return arguments.length?(n=a,e):n},e.renderPopup=function(a){return arguments.length?(i=a,e):i},e.brushOn=function(a){return arguments.length?(j=a,e):j};var o=function(a,b){var c=g[e.featureKeyAccessor()(a)];c&&c.d&&(b.key=c.d.key,e.renderPopup()&&b.bindPopup(e.popup()(c.d,a)),e.brushOn()&&b.on("click",p))},p=function(b){if(b.target){var c=b.target.key;a.events.trigger(function(){e.filter(c),a.redrawAll(e.chartGroup())})}};return e.anchor(c,d)},b.d3=d3,b.crossfilter=crossfilter,b.dc=a,b}if("function"==typeof define&&define.amd)define(["dc"],a);else if("object"==typeof module&&module.exports){var b=require("dc");module.exports=a(b)}else this.dc_leaflet=a(dc)}();
//# sourceMappingURL=dc.leaflet.min.js.map